2023-06-12 15:32:25.948965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-06-12 15:32:28.039370: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-06-12 15:32:28.040375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-06-12 15:32:28.064970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.62GHz coreCount: 72 deviceMemorySize: 22.17GiB deviceMemoryBandwidth: 581.23GiB/s
2023-06-12 15:32:28.065002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-06-12 15:32:28.067756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-06-12 15:32:28.067804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-06-12 15:32:28.070159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-06-12 15:32:28.070654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-06-12 15:32:28.073007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-06-12 15:32:28.073945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-06-12 15:32:28.078070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-06-12 15:32:28.081629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-06-12 15:32:28.082122: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-12 15:32:28.082257: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-06-12 15:32:28.084273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.62GHz coreCount: 72 deviceMemorySize: 22.17GiB deviceMemoryBandwidth: 581.23GiB/s
2023-06-12 15:32:28.084292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-06-12 15:32:28.084307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-06-12 15:32:28.084314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-06-12 15:32:28.084322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-06-12 15:32:28.084329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-06-12 15:32:28.084337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-06-12 15:32:28.084344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-06-12 15:32:28.084351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-06-12 15:32:28.086721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-06-12 15:32:28.086751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-06-12 15:32:28.695531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-06-12 15:32:28.695693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-06-12 15:32:28.695742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-06-12 15:32:28.702240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21047 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:06:00.0, compute capability: 7.5)
2023-06-12 15:32:29.594323: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-06-12 15:32:29.598236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2900000000 Hz
2023-06-12 15:32:29.719138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-06-12 15:32:29.930385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-06-12 15:32:30.889819: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2023-06-12 15:32:30.937222: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2023-06-12 15:32:42.650853: W tensorflow/core/common_runtime/bfc_allocator.cc:433] Allocator (GPU_0_bfc) ran out of memory trying to allocate 5.72GiB (rounded to 6144000000)requested by op model/multi_head_attention/softmax/Softmax
Current allocation summary follows.
2023-06-12 15:32:42.650948: I tensorflow/core/common_runtime/bfc_allocator.cc:972] BFCAllocator dump for GPU_0_bfc
2023-06-12 15:32:42.650976: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (256): 	Total Chunks: 60, Chunks in use: 60. 15.0KiB allocated for chunks. 15.0KiB in use in bin. 1.7KiB client-requested in use in bin.
2023-06-12 15:32:42.650992: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (512): 	Total Chunks: 9, Chunks in use: 9. 6.2KiB allocated for chunks. 6.2KiB in use in bin. 6.0KiB client-requested in use in bin.
2023-06-12 15:32:42.651008: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (1024): 	Total Chunks: 10, Chunks in use: 10. 10.2KiB allocated for chunks. 10.2KiB in use in bin. 10.0KiB client-requested in use in bin.
2023-06-12 15:32:42.651022: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (2048): 	Total Chunks: 15, Chunks in use: 15. 30.0KiB allocated for chunks. 30.0KiB in use in bin. 30.0KiB client-requested in use in bin.
2023-06-12 15:32:42.651037: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (4096): 	Total Chunks: 1, Chunks in use: 1. 5.2KiB allocated for chunks. 5.2KiB in use in bin. 4.7KiB client-requested in use in bin.
2023-06-12 15:32:42.651050: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-06-12 15:32:42.651063: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-06-12 15:32:42.651079: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (32768): 	Total Chunks: 2, Chunks in use: 2. 96.2KiB allocated for chunks. 96.2KiB in use in bin. 96.0KiB client-requested in use in bin.
2023-06-12 15:32:42.651095: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (65536): 	Total Chunks: 4, Chunks in use: 4. 369.5KiB allocated for chunks. 369.5KiB in use in bin. 336.0KiB client-requested in use in bin.
2023-06-12 15:32:42.651110: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (131072): 	Total Chunks: 3, Chunks in use: 3. 576.0KiB allocated for chunks. 576.0KiB in use in bin. 576.0KiB client-requested in use in bin.
2023-06-12 15:32:42.651124: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (262144): 	Total Chunks: 3, Chunks in use: 3. 1.12MiB allocated for chunks. 1.12MiB in use in bin. 1.12MiB client-requested in use in bin.
2023-06-12 15:32:42.651137: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-06-12 15:32:42.651153: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (1048576): 	Total Chunks: 15, Chunks in use: 15. 16.83MiB allocated for chunks. 16.83MiB in use in bin. 16.83MiB client-requested in use in bin.
2023-06-12 15:32:42.651166: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (2097152): 	Total Chunks: 2, Chunks in use: 1. 5.66MiB allocated for chunks. 2.00MiB in use in bin. 1.50MiB client-requested in use in bin.
2023-06-12 15:32:42.651178: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-06-12 15:32:42.651190: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-06-12 15:32:42.651203: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-06-12 15:32:42.651220: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (33554432): 	Total Chunks: 2, Chunks in use: 2. 100.00MiB allocated for chunks. 100.00MiB in use in bin. 100.00MiB client-requested in use in bin.
2023-06-12 15:32:42.651236: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (67108864): 	Total Chunks: 3, Chunks in use: 3. 330.38MiB allocated for chunks. 330.38MiB in use in bin. 284.38MiB client-requested in use in bin.
2023-06-12 15:32:42.651251: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (134217728): 	Total Chunks: 2, Chunks in use: 2. 468.75MiB allocated for chunks. 468.75MiB in use in bin. 468.75MiB client-requested in use in bin.
2023-06-12 15:32:42.651267: I tensorflow/core/common_runtime/bfc_allocator.cc:979] Bin (268435456): 	Total Chunks: 10, Chunks in use: 8. 19.65GiB allocated for chunks. 16.02GiB in use in bin. 16.02GiB client-requested in use in bin.
2023-06-12 15:32:42.651281: I tensorflow/core/common_runtime/bfc_allocator.cc:995] Bin for 5.72GiB was 256.00MiB, Chunk State: 
2023-06-12 15:32:42.651304: I tensorflow/core/common_runtime/bfc_allocator.cc:1001]   Size: 1.80GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 5.72GiB | Requested Size: 5.72GiB | in_use: 1 | bin_num: -1
2023-06-12 15:32:42.651324: I tensorflow/core/common_runtime/bfc_allocator.cc:1001]   Size: 1.83GiB | Requested Size: 937.50MiB | in_use: 0 | bin_num: 20, prev:   Size: 5.72GiB | Requested Size: 5.72GiB | in_use: 1 | bin_num: -1, next:   Size: 5.72GiB | Requested Size: 5.72GiB | in_use: 1 | bin_num: -1
2023-06-12 15:32:42.651335: I tensorflow/core/common_runtime/bfc_allocator.cc:1008] Next region of size 22069760512
2023-06-12 15:32:42.651350: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000000 of size 1280 next 1
2023-06-12 15:32:42.651361: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000500 of size 256 next 5
2023-06-12 15:32:42.651371: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000600 of size 256 next 8
2023-06-12 15:32:42.651381: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000700 of size 256 next 2
2023-06-12 15:32:42.651391: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000800 of size 256 next 3
2023-06-12 15:32:42.651400: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000900 of size 256 next 4
2023-06-12 15:32:42.651410: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000a00 of size 256 next 10
2023-06-12 15:32:42.651421: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000b00 of size 768 next 6
2023-06-12 15:32:42.651431: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54000e00 of size 768 next 7
2023-06-12 15:32:42.651459: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54001100 of size 256 next 13
2023-06-12 15:32:42.651469: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54001200 of size 256 next 14
2023-06-12 15:32:42.651480: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54001300 of size 1024 next 9
2023-06-12 15:32:42.651490: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54001700 of size 256 next 18
2023-06-12 15:32:42.651499: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54001800 of size 256 next 19
2023-06-12 15:32:42.651510: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54001900 of size 2048 next 17
2023-06-12 15:32:42.651520: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54002100 of size 256 next 23
2023-06-12 15:32:42.651529: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54002200 of size 256 next 24
2023-06-12 15:32:42.651539: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54002300 of size 2048 next 22
2023-06-12 15:32:42.651550: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54002b00 of size 2048 next 25
2023-06-12 15:32:42.651560: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54003300 of size 2048 next 28
2023-06-12 15:32:42.651570: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54003b00 of size 256 next 31
2023-06-12 15:32:42.651580: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54003c00 of size 256 next 32
2023-06-12 15:32:42.651590: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54003d00 of size 2048 next 30
2023-06-12 15:32:42.651600: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004500 of size 256 next 35
2023-06-12 15:32:42.651609: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004600 of size 256 next 36
2023-06-12 15:32:42.651618: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004700 of size 256 next 34
2023-06-12 15:32:42.651628: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004800 of size 768 next 42
2023-06-12 15:32:42.651638: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004b00 of size 256 next 45
2023-06-12 15:32:42.651647: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004c00 of size 256 next 46
2023-06-12 15:32:42.651657: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54004d00 of size 1024 next 44
2023-06-12 15:32:42.651667: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005100 of size 256 next 52
2023-06-12 15:32:42.651676: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005200 of size 256 next 55
2023-06-12 15:32:42.651686: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005300 of size 256 next 56
2023-06-12 15:32:42.651695: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005400 of size 256 next 49
2023-06-12 15:32:42.651705: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005500 of size 256 next 50
2023-06-12 15:32:42.651714: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005600 of size 256 next 51
2023-06-12 15:32:42.651724: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005700 of size 256 next 57
2023-06-12 15:32:42.651733: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005800 of size 256 next 58
2023-06-12 15:32:42.651743: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005900 of size 256 next 59
2023-06-12 15:32:42.651753: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005a00 of size 256 next 60
2023-06-12 15:32:42.651762: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005b00 of size 256 next 53
2023-06-12 15:32:42.651772: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54005c00 of size 1024 next 54
2023-06-12 15:32:42.651781: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006000 of size 256 next 61
2023-06-12 15:32:42.651791: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006100 of size 256 next 62
2023-06-12 15:32:42.651800: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006200 of size 768 next 63
2023-06-12 15:32:42.651810: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006500 of size 256 next 64
2023-06-12 15:32:42.651820: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006600 of size 512 next 66
2023-06-12 15:32:42.651830: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006800 of size 1024 next 67
2023-06-12 15:32:42.651840: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54006c00 of size 2048 next 68
2023-06-12 15:32:42.651849: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54007400 of size 2048 next 70
2023-06-12 15:32:42.651860: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54007c00 of size 2048 next 72
2023-06-12 15:32:42.651870: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54008400 of size 2048 next 74
2023-06-12 15:32:42.651880: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54008c00 of size 2048 next 76
2023-06-12 15:32:42.651889: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54009400 of size 256 next 77
2023-06-12 15:32:42.651899: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54009500 of size 768 next 78
2023-06-12 15:32:42.651909: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54009800 of size 1024 next 80
2023-06-12 15:32:42.651919: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54009c00 of size 1024 next 81
2023-06-12 15:32:42.651928: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400a000 of size 256 next 82
2023-06-12 15:32:42.651938: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400a100 of size 768 next 83
2023-06-12 15:32:42.651948: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400a400 of size 256 next 84
2023-06-12 15:32:42.651957: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400a500 of size 512 next 85
2023-06-12 15:32:42.651967: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400a700 of size 1024 next 87
2023-06-12 15:32:42.651977: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400ab00 of size 2048 next 89
2023-06-12 15:32:42.651987: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400b300 of size 2048 next 91
2023-06-12 15:32:42.651996: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400bb00 of size 2048 next 93
2023-06-12 15:32:42.652005: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400c300 of size 2048 next 95
2023-06-12 15:32:42.652015: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400cb00 of size 2048 next 97
2023-06-12 15:32:42.652024: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400d300 of size 256 next 99
2023-06-12 15:32:42.652034: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400d400 of size 768 next 101
2023-06-12 15:32:42.652044: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400d700 of size 1024 next 103
2023-06-12 15:32:42.652054: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400db00 of size 1024 next 104
2023-06-12 15:32:42.652064: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400df00 of size 256 next 105
2023-06-12 15:32:42.652073: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e000 of size 256 next 106
2023-06-12 15:32:42.652082: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e100 of size 256 next 107
2023-06-12 15:32:42.652092: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e200 of size 256 next 108
2023-06-12 15:32:42.652102: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e300 of size 256 next 109
2023-06-12 15:32:42.652112: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e400 of size 256 next 110
2023-06-12 15:32:42.652121: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e500 of size 256 next 111
2023-06-12 15:32:42.652131: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e600 of size 256 next 112
2023-06-12 15:32:42.652140: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e700 of size 256 next 113
2023-06-12 15:32:42.652150: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e800 of size 256 next 114
2023-06-12 15:32:42.652159: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400e900 of size 256 next 115
2023-06-12 15:32:42.652169: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400ea00 of size 256 next 116
2023-06-12 15:32:42.652179: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400eb00 of size 256 next 117
2023-06-12 15:32:42.652189: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400ec00 of size 256 next 118
2023-06-12 15:32:42.652199: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400ed00 of size 256 next 119
2023-06-12 15:32:42.652209: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400ee00 of size 256 next 120
2023-06-12 15:32:42.652218: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400ef00 of size 256 next 123
2023-06-12 15:32:42.652227: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400f000 of size 256 next 124
2023-06-12 15:32:42.652236: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400f100 of size 256 next 125
2023-06-12 15:32:42.652246: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400f200 of size 256 next 126
2023-06-12 15:32:42.652257: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5400f300 of size 5376 next 39
2023-06-12 15:32:42.652266: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54010800 of size 256 next 40
2023-06-12 15:32:42.652276: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54010900 of size 256 next 41
2023-06-12 15:32:42.652286: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54010a00 of size 49408 next 43
2023-06-12 15:32:42.652297: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5401cb00 of size 83456 next 12
2023-06-12 15:32:42.652306: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54031100 of size 98304 next 11
2023-06-12 15:32:42.652317: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54049100 of size 393216 next 48
2023-06-12 15:32:42.652328: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c540a9100 of size 196608 next 47
2023-06-12 15:32:42.652338: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c540d9100 of size 98304 next 65
2023-06-12 15:32:42.652348: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c540f1100 of size 98304 next 16
2023-06-12 15:32:42.652358: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54109100 of size 393216 next 15
2023-06-12 15:32:42.652369: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54169100 of size 2097152 next 26
2023-06-12 15:32:42.652379: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54369100 of size 1048576 next 21
2023-06-12 15:32:42.652389: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54469100 of size 1572864 next 20
2023-06-12 15:32:42.652398: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c545e9100 of size 1048576 next 27
2023-06-12 15:32:42.652409: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c546e9100 of size 1048576 next 29
2023-06-12 15:32:42.652418: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c547e9100 of size 1048576 next 33
2023-06-12 15:32:42.652428: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c548e9100 of size 1048576 next 69
2023-06-12 15:32:42.652437: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c549e9100 of size 1048576 next 71
2023-06-12 15:32:42.652454: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54ae9100 of size 1048576 next 73
2023-06-12 15:32:42.652463: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54be9100 of size 1048576 next 75
2023-06-12 15:32:42.652474: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c54ce9100 of size 100663296 next 38
2023-06-12 15:32:42.652485: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5ace9100 of size 52428800 next 37
2023-06-12 15:32:42.652496: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5dee9100 of size 196608 next 79
2023-06-12 15:32:42.652505: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5df19100 of size 393216 next 86
2023-06-12 15:32:42.652515: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5df79100 of size 1572864 next 88
2023-06-12 15:32:42.652524: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5e0f9100 of size 1048576 next 90
2023-06-12 15:32:42.652534: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5e1f9100 of size 1048576 next 92
2023-06-12 15:32:42.652544: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5e2f9100 of size 1048576 next 94
2023-06-12 15:32:42.652553: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5e3f9100 of size 1048576 next 96
2023-06-12 15:32:42.652563: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c5e4f9100 of size 52428800 next 98
2023-06-12 15:32:42.652574: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c616f9100 of size 49152 next 100
2023-06-12 15:32:42.652584: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c61705100 of size 196608 next 102
2023-06-12 15:32:42.652593: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] Free  at 2b2c61735100 of size 3840000 next 121
2023-06-12 15:32:42.652603: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c61ade900 of size 256 next 122
2023-06-12 15:32:42.652614: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c61adea00 of size 1920000 next 127
2023-06-12 15:32:42.652624: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c61cb3600 of size 122880000 next 128
2023-06-12 15:32:42.652634: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c691e3600 of size 122880000 next 129
2023-06-12 15:32:42.652644: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c70713600 of size 245760000 next 130
2023-06-12 15:32:42.652655: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c7f173600 of size 245760000 next 131
2023-06-12 15:32:42.652664: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2c8dbd3600 of size 491520000 next 132
2023-06-12 15:32:42.652674: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2cab093600 of size 491520000 next 133
2023-06-12 15:32:42.652684: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2cc8553600 of size 983040000 next 134
2023-06-12 15:32:42.652694: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2d02ed3600 of size 983040000 next 135
2023-06-12 15:32:42.652704: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2d3d853600 of size 983040000 next 136
2023-06-12 15:32:42.652713: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2d781d3600 of size 983040000 next 137
2023-06-12 15:32:42.652723: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2db2b53600 of size 6144000000 next 138
2023-06-12 15:32:42.652734: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] Free  at 2b2f20eb3600 of size 1966080000 next 140
2023-06-12 15:32:42.652744: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] InUse at 2b2f961b3600 of size 6144000000 next 141
2023-06-12 15:32:42.652754: I tensorflow/core/common_runtime/bfc_allocator.cc:1028] Free  at 2b3104513600 of size 1931779072 next 18446744073709551615
2023-06-12 15:32:42.652763: I tensorflow/core/common_runtime/bfc_allocator.cc:1033]      Summary of in-use Chunks by size: 
2023-06-12 15:32:42.652777: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 60 Chunks of size 256 totalling 15.0KiB
2023-06-12 15:32:42.652789: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 512 totalling 1.0KiB
2023-06-12 15:32:42.652801: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 7 Chunks of size 768 totalling 5.2KiB
2023-06-12 15:32:42.652812: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 9 Chunks of size 1024 totalling 9.0KiB
2023-06-12 15:32:42.652823: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 1280 totalling 1.2KiB
2023-06-12 15:32:42.652834: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 15 Chunks of size 2048 totalling 30.0KiB
2023-06-12 15:32:42.652845: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 5376 totalling 5.2KiB
2023-06-12 15:32:42.652856: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 49152 totalling 48.0KiB
2023-06-12 15:32:42.652868: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 49408 totalling 48.2KiB
2023-06-12 15:32:42.652879: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 83456 totalling 81.5KiB
2023-06-12 15:32:42.652891: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 3 Chunks of size 98304 totalling 288.0KiB
2023-06-12 15:32:42.652902: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 3 Chunks of size 196608 totalling 576.0KiB
2023-06-12 15:32:42.652913: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 3 Chunks of size 393216 totalling 1.12MiB
2023-06-12 15:32:42.652925: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 12 Chunks of size 1048576 totalling 12.00MiB
2023-06-12 15:32:42.652936: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 1572864 totalling 3.00MiB
2023-06-12 15:32:42.652947: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 1920000 totalling 1.83MiB
2023-06-12 15:32:42.652958: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 2097152 totalling 2.00MiB
2023-06-12 15:32:42.652969: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 52428800 totalling 100.00MiB
2023-06-12 15:32:42.652980: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 1 Chunks of size 100663296 totalling 96.00MiB
2023-06-12 15:32:42.652992: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 122880000 totalling 234.38MiB
2023-06-12 15:32:42.653004: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 245760000 totalling 468.75MiB
2023-06-12 15:32:42.653015: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 491520000 totalling 937.50MiB
2023-06-12 15:32:42.653026: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 4 Chunks of size 983040000 totalling 3.66GiB
2023-06-12 15:32:42.653038: I tensorflow/core/common_runtime/bfc_allocator.cc:1036] 2 Chunks of size 6144000000 totalling 11.44GiB
2023-06-12 15:32:42.653050: I tensorflow/core/common_runtime/bfc_allocator.cc:1040] Sum Total of in-use chunks: 16.92GiB
2023-06-12 15:32:42.653060: I tensorflow/core/common_runtime/bfc_allocator.cc:1042] total_region_allocated_bytes_: 22069760512 memory_limit_: 22069760512 available bytes: 0 curr_region_allocation_bytes_: 44139521024
2023-06-12 15:32:42.653077: I tensorflow/core/common_runtime/bfc_allocator.cc:1048] Stats: 
Limit:                     22069760512
InUse:                     18168061440
MaxInUse:                  20134141440
NumAllocs:                         211
MaxAllocSize:               6144000000
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2023-06-12 15:32:42.653106: W tensorflow/core/common_runtime/bfc_allocator.cc:441] *******************************************************________*****************************________
2023-06-12 15:32:42.653156: W tensorflow/core/framework/op_kernel.cc:1763] OP_REQUIRES failed at softmax_op_gpu.cu.cc:224 : Resource exhausted: OOM when allocating tensor with shape[1200,8,400,400] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
Traceback (most recent call last):
  File "single_index_predict.py", line 443, in <module>
    model.fit(train_generator, epochs=epochs, validation_data=val_generator, callbacks=[early_stop, checkpoint_callback], verbose=2)
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1100, in fit
    tmp_logs = self.train_function(iterator)
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 888, in _call
    return self._stateless_fn(*args, **kwds)
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2942, in __call__
    return graph_function._call_flat(
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1918, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 555, in call
    outputs = execute.execute(
  File "/u/atya/conda-envs/tf-gpu4/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[1200,8,400,400] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node model/multi_head_attention/softmax/Softmax (defined at single_index_predict.py:443) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_1631]

Function call stack:
train_function

srun: error: hcg040: task 0: Exited with exit code 1
srun: launch/slurm: _step_signal: Terminating StepId=1195431.0

real	0m18.245s
user	0m0.009s
sys	0m0.009s
